# 렌더링 전략

### Transpile의 동작

- Babel

    - ECMAScript 같은 js 최신 버전이나, TypeScript 이전 버전의 코드로 변환 시키는 Transpile 도구이다.

    - AST(Abstract Syntax Tree)

        - 소스 코드를 추상화된 트리 구조로 나타낸 것

    - Babel의 parser는 js 코드를 컴퓨터가 이해하기 쉽게 변환해준다.

    - 싱글 쓰레드로 실행되기 때문에 속도가 느리다는 단점

- SWC

    - Next 12 이후 Babel에서 SWC로 교체되었다.

    - SWC는 Rust로 작성되어 속도가 훨씬 빠르다

    ※ 속도가 빠른 이유는 Rust에는 WASM(WebAssembly)이라는게 있는데 이게 어셈블리어로 되어있다.(저급언어)

## 서버 사이드 렌더링(SSR)

- APM을 사용하는 웹 페이지 생성

- 자바스크립트 코드 적재되면 동적으로 페이지 내용을 렌더링한다.

- Next.js도 동적으로 페이지를 렌더링할 수 있다.

- 리액트 하이드레이션 : 

    - 서버에서 렌더링된 HTML 마크업에 기반하여  클라이언트 측에서 자바스크립트 이벤트와 상태를 연결하는 과정을 말한다.

- 장점

    - 안전한 웹 애플리케이션 : 인증 또는 민감한 작업을 서버에서 수행하고 그 결과만 브라우저에 제공해 위협을 피할 수 있다.

    - 뛰어난 웹 사이트 호환성 : 클라이언트 환경이 오래된 브라우저도 서비스를 제공한다.

    - 뛰어난 SEO : 서버가 렌더링한 HTML을 받기에 웹 크롤러가 페이지를 렌더링할 필요가 없음

- 단점

    - 페이지간의 이동은 CSR에 비해 느리다.

    - 서버 과부하

    - 깜빡임 이슈 (매번 새로고침 해야하기 때문에)

- SSR은 만능이 아니다.

    - 단순히 서버가 SPA(Single Page App)를 렌더링한다고 모든 것이 해결되지 않음. 
    - 오히려 자바스크립트 코드를 증가시키며, 애플리케이션이 인터렉티브 할 때까지 걸리는 시간이 단순 클라이언트 렌더링보다 더 길어질 수 있다.

## 클라이언트 사이드 렌더링(CSR)

- 실제 렌더링이 클라이언트에서 이루어지는 방식

- React 앱을 실행하면 렌더링 시작 전에 빈 화면이 한동안 유지 되는 것이 보임

- **장점**

    - 네이티브 앱처럼 느껴지는 웹 앱

        - 전체 자바스크립트 번들을 다운로드 한다는 것은 렌더링할 모든 페이지가 이미 브라우저에 다운로드 되어 있다는 뜻

        - 다른 페이지로 이동해도 서버에 요청할 필요 없이 바로 이동

        - 페이지를 바꾸기 위해 새로 고침이 없다.
    
    - 쉬운 페이지 전환

        - 클라이언트에서 네비게이션이 새로고침이 발생하지 않아 UX에 도움이 된다.

    - 지연된 로딩과 성능

        - 초기 로딩 이후 빠른 웹사이트 렌더링이 가능(웹사이트가 로딩되는 즉시 상호작용 가능

- **단점**

    - 네크워크가 속도가 느린 환경에서는 번들이 모두 다운로드 될 때까지 빈 페이지를 보아야함

    - 검색 로봇에게도 그 내용은 빈 것으로 보인다.

    - 번들을 모두 받을 때까지 검색 로봇이 기다리기는 하지만 성능 점수는 낮다.


## 정적 사이트 생성(SSG)

- SSG는 일부 또는 전체 페이지를 빌드 시점에 미리 렌더링

**장점**

1. 쉬운 확장 : 정적 페이지는 HTML 파일으므로 CDN을 통해 파일을 제공하거나, 캐시에 저장하기 쉬움

2. 뛰어난 성능 : 빌드 시점에 미리 렌더링하기 때문에 페이지를 요청해도 클라이언트나 서버가 무언가를 처리할 필요가 없음

3. 더안전한 API 요청 : 외부 API를 호출하거나, DB에 접근하거나, 보호해야 할 데이터에 접근할 일이 없다.
필요한 모든 정보가 빌드 시 포함되어 있기 때문이다.

**단점**

1. 제한된 동적 콘텐츠 처리 : 페이지가 완전히 정적이므로, 동적인 대시보드나 사용자 기반 콘텐츠 표시가 어렵움

2. 빌드 시간 증가 : 사이트에 많은 페이지가 있을 경우, 모든 페이지를 사전 렌더링하는 데 시간이 많이 걸릴 수 있다.

3. 빈번한 재빌드 필요 : 데이터가 자주 변경되는 경우, 사이트를 자주 재빌드해야 한다.
